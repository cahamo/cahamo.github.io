---
layout: default
title: "Electronic tongue drum: ESP32 touch sensor pin experiment"
---
<h1>Experiment #9: Testing the EXP32&rsquo;s built in touch sensor pins</h1>

<p>Ever since it came to my notice that the ESP32 microcontroller has eight or nine built in touch pins (depending on the board), it struck me that I should check these pins out before committing to using the CapacitiveSensor library for the electro tongue drum.</p>

<p>This experiment tests a single touch sensor connected to a single ESP32 touch sensor pin.</p>

<h2>Methodology</h2>

<p>Sensor #9G, a vinyl covered, grounded, sensor was connected directly to an ESP32 touch sensor pin and the readings were graphed on a serial plotter. The output of the serial plotter was captured in screen shots.</p>

<p>The output from the touch pin was first recorded without touching the sensor and then after tapping the sensor three times slowly and then three times quickly. The experiment was repeated with the sensor grounded and ungrounded.</p>

<h2>Circuit</h2>

<p>The ESP32&rsquo;s touch pin 0 was used. This is found on GPIO pin #4 on my development board. Therefore GPIO pin #4 was connected to the sensor's output pin. Additionally the ESP32&rsquo;s GND pin was connected to sensor&rsquo;s ground pin.</p>

<p><img class="img-fluid mx-auto d-block" src="/assets/img/projects/tongue-drum/exp-9/circuit-photo.jpg"
    width="740" height="583" alt="Photo of circuit used for experiment #9"></p>

<h2>Code</h2>

<p>Firstly, the ESP32 boards were installed into the Arduino IDE&rsquo;s Boards Manager as explained in the &ldquo;<a href="https://dronebotworkshop.com/esp32-intro/">Getting started with ESP32</a>&rdquo; article on the DroneBot Workshop website.</p>

<p>Then a new sketch was written to read the input from the ESP32&rsquo;s touch sensor #0 and to write the readings to the serial port. This sketch is <a href="https://github.com/cahamo/electro-tongue-drum/tree/main/src/research/ESP32SingleSensorRawDataLogger"><code>ESP32SingleSensorRawDataLogger.ino</code></a>.</p>

<p>The script was based on one found on the &ldquo;<a href="https://dronebotworkshop.com/esp32-intro/">Getting started with ESP32</a>&rdquo; article mentioned above.</p>

<h2>Results</h2>

<p class="alert alert-info">It should be noted that the results obtained from the EPS32 touch pin are the inverse of those obtained with the CapacitiveSensor library. With the ESP32, a high value is returned when the sensor is not touched and the value <em>drops</em> when it is touched.</p>

<p>The results of <em>not</em> touching the sensor, both with and without grounding, are shown in the following carousel. As can be seen, in both cases, the sensor reading was level.</p>

<div id="carouselIndicatorsA" class="carousel slide mb-3" data-ride="carousel">
    <ol class="carousel-indicators">
        <li data-target="#carouselIndicatorsA" data-slide-to="0" class="active"></li>
        <li data-target="#carouselIndicatorsA" data-slide-to="1"></li>
    </ol>
    <div class="carousel-inner">
        <div class="carousel-item active">
            <img class="d-block w-100" src="/assets/img/projects/tongue-drum/exp-9/graph--grounded--not-touched.png"
                alt="Graph of ESP32 touch sensor output for grounded sensor not being touched">
        </div>
        <div class="carousel-item">
            <img class="d-block w-100" src="/assets/img/projects/tongue-drum/exp-9/graph--ungrounded--not-touched.png"
            alt="Graph of ESP32 touch sensor output for ungrounded sensor not being touched">
        </div>
        <a class="carousel-control-prev" href="#carouselIndicatorsA" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselIndicatorsA" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
</div>

<p>However, re-running the &ldquo;Untouched&rdquo; tests revealed some apparent interference, as can be seen in the following image carousel:</p>

<div id="carouselIndicatorsB" class="carousel slide mb-3" data-ride="carousel">
    <ol class="carousel-indicators">
        <li data-target="#carouselIndicatorsB" data-slide-to="0" class="active"></li>
        <li data-target="#carouselIndicatorsB" data-slide-to="1"></li>
    </ol>
    <div class="carousel-inner">
        <div class="carousel-item active">
            <img class="d-block w-100" src="/assets/img/projects/tongue-drum/exp-9/graph--grounded--not-touched--interference.png"
                alt="Graph of ESP32 touch sensor output for grounded sensor not being touched, with interference">
        </div>
        <div class="carousel-item">
            <img class="d-block w-100" src="/assets/img/projects/tongue-drum/exp-9/graph--ungrounded--not-touched--interference.png"
            alt="Graph of ESP32 touch sensor output for ungrounded sensor not being touched, with interference">
        </div>
        <a class="carousel-control-prev" href="#carouselIndicatorsB" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselIndicatorsB" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
</div>

<p>Finally, the graphs for tapping the sensor are shown below. Again the results for the grounded and ungrounded circuits are shown in a carousel:</p>

<div id="carouselIndicatorsC" class="carousel slide mb-3" data-ride="carousel">
    <ol class="carousel-indicators">
        <li data-target="#carouselIndicatorsC" data-slide-to="0" class="active"></li>
        <li data-target="#carouselIndicatorsC" data-slide-to="1"></li>
    </ol>
    <div class="carousel-inner">
        <div class="carousel-item active">
            <img class="d-block w-100" src="/assets/img/projects/tongue-drum/exp-9/graph--grounded--tapped.png"
                alt="Graph of ESP32 touch sensor output for grounded sensor being tapped">
        </div>
        <div class="carousel-item">
            <img class="d-block w-100" src="/assets/img/projects/tongue-drum/exp-9/graph--ungrounded--tapped.png"
            alt="Graph of ESP32 touch sensor output for ungrounded sensor being tapped">
        </div>
        <a class="carousel-control-prev" href="#carouselIndicatorsC" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselIndicatorsC" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
</div>

<h2>Conclusions</h2>

<p>The high readings for the ungrounded sensor are greater than those for the grounded sensor and the gap between lower and higher values is greater for the ungrounded sensor.</p>

<p>The situation when the sensor is untouched is strange. Multiple runs were undertaken. In some runs the &ldquo;flat-line&rdquo; results shown in the 1st image carousel were found while in others the &ldquo;interference&rdquo; observed in the second carousel was apparent.</p>

<p>Some of the spikes in values detected when interference is present and the sensor is not touched are large enough to mean that false positive readings could easily be registered. As a consequence some means of &ldquo;debouncing&rdquo; in software would be required in order to ignore such anomalies.</p>

<p>Using the ESP32 instead of an Arduino and the CapacitiveSensor library would greatly simplify code and wiring.</p>

<p class="lead">While the simplicity the ESP32 would bring to circuit and code design is attractive, the potential for interference to cause false tongue hits to be registered means that the CapacitiveSensor library will continue to be used, regardless of the chosen microcontroller.</p>
